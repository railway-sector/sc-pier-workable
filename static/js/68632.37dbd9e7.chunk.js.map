{"version":3,"file":"static/js/68632.37dbd9e7.chunk.js","mappings":"2KAIuJ,SAASA,EAAEA,GAAG,IAAIA,EAAE,MAAM,GAAG,IAAIC,GAAEC,EAAAA,EAAAA,IAAEF,GAAG,CAACA,GAAGG,EAAAA,EAAEC,aAAaJ,GAAGA,EAAEK,UAAUC,MAAMC,QAAQP,GAAGA,EAAE,GAAG,OAAOC,EAAEA,GAAGO,OAAOC,EAAAA,IAAG,KAAKR,GAAGS,QAAQ,GAAG,GAAGT,CAAC,C,iNCAirB,IAAIU,EAAE,cAAcT,EAAAA,EAAE,YAAIU,GAAW,OAAOC,KAAKC,cAAcF,WAAU,CAAE,CAACG,WAAAA,CAAYf,GAAGgB,MAAMhB,GAAGa,KAAKI,iBAAiB,IAAIC,IAAIL,KAAKM,oBAAoB,KAAKN,KAAKO,SAAS,IAAIC,EAAAA,EAAER,KAAKC,aAAa,KAAKD,KAAKS,WAAU,EAAG,MAAMpB,EAAE,IAAID,EAAAA,EAAE,CAAC,IAAI,IAAI,IAAI,EAAE,MAAMY,KAAKU,SAAS,IAAIL,IAAI,CAAC,CAAC,QAAQ,IAAIM,EAAAA,EAAE,CAACC,KAAK,MAAMC,MAAM,SAASC,MAAMzB,KAAK,CAAC,WAAW,IAAI0B,EAAAA,EAAE,CAACC,MAAM,MAAMF,MAAMzB,KAAK,CAAC,UAAU,IAAI4B,EAAAA,EAAE,CAACC,QAAQ,KAAKJ,MAAMzB,MAAM,CAAC8B,SAAAA,CAAUhC,EAAEC,GAAG,MAAMC,GAAE+B,EAAAA,EAAAA,GAAEjC,GAAG,GAAG,IAAIE,EAAEQ,OAAO,OAAOwB,EAAAA,EAAAA,MAAI,IAAIzB,EAAEN,GAAE,EAAG,OAAOU,KAAKsB,gBAAgBC,WAAWC,QAAQC,IAAI,CAACzB,KAAK0B,yBAAyBrC,GAAGW,KAAK2B,0BAA0BC,KAAKC,IAAS,IAAP1C,EAAEE,GAAEwC,GAAKvC,GAAGD,IAAIO,EAAEI,KAAK8B,sBAAsBzC,EAAEF,EAAEC,QAAOiC,EAAAA,EAAAA,IAAE,KAAK/B,GAAE,EAAGM,GAAGmC,UAAU,CAACC,OAAAA,GAAUhC,KAAK2B,uBAAuB,CAACG,qBAAAA,CAAsB3C,EAAEC,EAAEC,GAAG,IAAI,MAAMgC,KAAKjC,EAAEY,KAAKI,iBAAiB6B,IAAIZ,GAAGrB,KAAKI,iBAAiB8B,IAAIb,IAAI,GAAG,GAAGrB,KAAKO,SAAS4B,QAAQ/C,GAAG,MAAMQ,EAAET,EAAEgC,UAAU/B,EAAEC,GAAG,OAAOgC,EAAAA,EAAAA,IAAE,KAAKrB,KAAKoC,yBAAyBhD,GAAGQ,EAAEmC,UAAU,CAACK,wBAAAA,CAAyBjD,GAAGa,KAAKO,SAAS8B,WAAWlD,EAAEQ,OAAOR,IAAI,MAAMC,EAAEkD,KAAKC,IAAI,GAAGvC,KAAKI,iBAAiB8B,IAAI/C,IAAI,GAAG,GAAG,OAAO,IAAIC,GAAGY,KAAKI,iBAAiBoC,OAAOrD,IAAG,IAAKa,KAAKI,iBAAiB6B,IAAI9C,EAAEC,IAAG,KAAM,CAAC,2BAAMuC,GAAwB,GAAG3B,KAAKC,aAAa,OAAOD,KAAKC,aAAaD,KAAKM,sBAAsBN,KAAKM,oBAAoB,uEAAgC,MAAMmC,QAAQtD,SAASa,KAAKM,oBAAoB,GAAGN,KAAK0C,UAAU,OAAO,KAAK,MAAMtD,EAAE,IAAID,EAAE,CAACwD,KAAK3C,KAAK2C,KAAKC,MAAM,CAACC,KAAK,yBAAyBC,GAAG9C,KAAK4C,MAAME,GAAGC,IAAI/C,KAAK4C,MAAMG,IAAIC,cAAc,CAACC,KAAK,kBAAkBC,YAAYA,IAAIlD,KAAKO,SAAS4C,0BAA0B,KAAK,OAAOnD,KAAKoD,KAAK,eAAehE,GAAGY,KAAKqD,WAAW,EAAC/D,EAAAA,EAAAA,IAAEU,KAAKC,eAAcqD,EAAAA,EAAAA,IAAE,IAAItD,KAAKS,UAAUtB,IAAIC,EAAEqB,UAAUtB,GAAGoE,EAAAA,MAAKnE,CAAC,CAAC,8BAAMsC,CAAyBvC,GAAG,MAAMC,EAAED,EAAEqE,IAAIC,IAAA,IAAEC,SAASvE,GAAEsE,EAAA,OAAGtE,GAAGwE,mBAAkBhE,OAAOC,EAAAA,IAAGgE,OAAO,CAACzE,EAAEC,KAAK,IAAID,EAAEU,QAAQV,EAAE0E,IAAI,IAAIC,OAAO1E,IAAID,EAAE4E,KAAK3E,GAAGD,GAAG,IAAIE,EAAEW,KAAK2C,KAAKgB,iBAAiBtC,EAAEjC,EAAEoE,IAAIrE,IAAC,CAAI6E,OAAO7E,EAAE8E,KAAK5E,KAAK,UAAU6E,EAAAA,EAAAA,sBAAE7C,EAAE,CAAC,MAAM,MAAM,EAAE,CAAC,OAAOlC,EAAEqE,IAAIrE,IAAI,MAAMuE,SAAStE,GAAGD,EAAE,IAAI,MAAMS,EAAER,GAAE+E,EAAAA,EAAAA,SAAE/E,EAAEC,GAAG,KAAKgC,EAAElC,EAAEiF,eAAe,OAAO/C,EAAEqC,SAAS9D,EAAEyB,EAAEgD,OAAOrE,KAAKU,SAASwB,IAAItC,GAAGiD,MAAMxB,CAAC,CAAC,MAAM,OAAOlC,CAAC,GAAG,IAAGA,EAAAA,EAAAA,IAAE,EAACmF,EAAAA,EAAAA,OAAKxE,EAAEyE,UAAU,gBAAW,IAAQpF,EAAAA,EAAAA,IAAE,EAACmF,EAAAA,EAAAA,OAAKxE,EAAEyE,UAAU,oBAAe,IAAQpF,EAAAA,EAAAA,IAAE,EAACmF,EAAAA,EAAAA,OAAKxE,EAAEyE,UAAU,YAAO,IAAQpF,EAAAA,EAAAA,IAAE,EAACmF,EAAAA,EAAAA,OAAKxE,EAAEyE,UAAU,aAAQ,IAAQpF,EAAAA,EAAAA,IAAE,EAACmF,EAAAA,EAAAA,OAAKxE,EAAEyE,UAAU,uBAAkB,IAAQpF,EAAAA,EAAAA,IAAE,EAACmF,EAAAA,EAAAA,OAAKxE,EAAEyE,UAAU,iBAAY,IAAQpF,EAAAA,EAAAA,IAAE,EAACmF,EAAAA,EAAAA,OAAKxE,EAAEyE,UAAU,WAAW,MAAMzE,GAAEX,EAAAA,EAAAA,IAAE,EAACqF,EAAAA,EAAAA,GAAE,wDAAwD1E,E,qMCAtkF,MAAMsB,EAAEA,IAAI,MAAML,EAAEK,EAAE,IAAIqD,EAAE,cAAc1D,EAAEb,WAAAA,GAAkBC,SAAMuE,WAAM1E,KAAK2C,KAAK,IAAI,CAAC,cAAIgC,GAAa,OAAOT,EAAAA,EAAAA,GAAElE,KAAK4C,MAAM5C,KAAK2C,MAAMgC,WAAW3E,KAAK4E,KAAK,cAAc,CAAC,kCAAMC,CAA6BzF,EAAEE,GAAG,MAAMsD,MAAMvB,GAAGrB,KAAK,IAAIZ,EAAE,MAAM,IAAIC,EAAAA,EAAE,sCAAsC,gCAAgC,CAACuD,MAAMvB,IAAI,MAAMyD,aAAaZ,GAAG7C,EAAEmD,GAAEL,EAAAA,EAAAA,IAAE9C,EAAE/B,GAAG,IAAI4E,GAAG,MAAMM,EAAE,MAAM,GAAG,MAAMvD,QAAQuD,EAAEO,kBAAkB,KAAK,CAACC,MAAM,IAAIV,EAAAA,EAAEjD,EAAE4D,cAAcC,WAAW,IAAI7E,IAAI,CAAC,CAAC,SAASgB,EAAE4D,aAAatF,OAAOP,GAAGA,EAAE+F,KAAKC,WAAW7B,EAAAA,KAAIC,IAAIpE,GAAGA,EAAE+F,OAAO,CAAC,uBAAuB9D,EAAEgE,OAAO7B,IAAIpE,GAAGA,EAAE+F,YAAWvF,EAAAA,EAAAA,IAAEN,GAAG,MAAM8B,EAAE,IAAIT,EAAAA,EAAES,EAAEuD,WAAW3E,KAAK2E,WAAWvD,EAAEsC,SAAStE,EAAEgC,EAAEkE,UAAUrE,EAAEG,EAAEmE,oBAAoBnG,EAAEuE,iBAAiB,MAAM6B,WAAWzE,EAAE4C,iBAAiBc,GAAGzE,KAAK2C,KAAKW,EAAE,OAAOtD,KAAK2C,KAAKE,KAAK,IAAI1D,EAAAA,EAAE4B,EAAEA,EAAE0D,GAAG,IAAItF,EAAAA,EAAE,GAAG4B,EAAE,GAAGA,EAAE0D,IAAIgB,oBAAoB3F,EAAE4F,kBAAkBC,GAAGnB,EAAEoB,cAAc,CAACH,qBAAoB,EAAGC,mBAAkB,GAAIG,EAAE,CAACC,oBAAmB,EAAGL,oBAAoB3F,EAAEiG,UAAUzC,EAAEoC,kBAAkBC,EAAEK,OAAO1G,GAAG0G,QAAQ,OAAO3E,EAAE4E,oBAAoB7E,EAAEyE,EAAE,CAAC,oBAAMK,GAAiB,aAAa1B,EAAAA,EAAAA,YAAUxE,KAAK4C,MAAMuD,QAAOlF,EAAAA,EAAAA,IAAEjB,KAAK4C,MAAMwD,kBAAkBpG,KAAK2C,KAAKgB,iBAAiB,CAAC0C,SAAAA,GAAY,QAAQlG,MAAMkG,cAAcrG,KAAK2E,YAAY2B,OAAO,GAAG,OAAOlH,EAAAA,EAAAA,IAAE,EAACE,EAAAA,EAAAA,OAAKmF,EAAEF,UAAU,aAAQ,IAAQnF,EAAAA,EAAAA,IAAE,EAACE,EAAAA,EAAAA,OAAKmF,EAAEF,UAAU,iBAAY,IAAQnF,EAAAA,EAAAA,IAAE,EAACE,EAAAA,EAAAA,IAAE,CAACiH,UAAS,KAAM9B,EAAEF,UAAU,aAAa,OAAMnF,EAAAA,EAAAA,IAAE,EAACE,EAAAA,EAAAA,OAAKmF,EAAEF,UAAU,YAAO,GAAQE,GAAErF,EAAAA,EAAAA,IAAE,EAACiC,EAAAA,EAAAA,GAAE,uCAAuCoD,GAAGA,E,mLCAh3D,IAAIpD,EAAE,cAAczB,EAAAA,EAAEM,WAAAA,CAAYd,GAAGe,MAAMf,GAAGY,KAAKwG,iBAAgBlC,EAAAA,EAAAA,IAAEmC,UAAUzG,KAAK0G,OAAO,CAACtH,EAAEkF,IAAItE,KAAK2G,aAAavH,EAAEkF,GAAGlF,IAAI,IAAI,CAACwH,UAAAA,GAAa5G,KAAKqD,WAAW,EAAClE,EAAAA,EAAAA,IAAE,IAAIa,KAAK2C,KAAKkE,eAAeC,MAAM,IAAI9G,KAAK+G,mCAAmC,CAACC,MAAK,EAAGC,SAAQ,IAAKjH,KAAK4C,MAAMsE,GAAG,SAAS,IAAIlH,KAAKsB,gBAAgBC,WAAWvB,KAAKwG,qBAAqB,CAACO,gCAAAA,GAAmC/G,KAAKmH,sBAAsBnH,KAAK4C,MAAMwE,OAAOpH,KAAK4C,MAAMwD,kBAAkBL,UAAU,IAAI,CAAC,mBAAMsB,CAAcjI,EAAEkF,EAAEnF,GAAGmF,EAAEgD,qBAAqBlI,EAAEmI,MAAMjD,EAAEgD,sBAAsBlI,EAAEmI,MAAMC,SAASC,cAAc,UAAUrI,EAAEsI,UAAUpD,EAAEoD,gBAAgB1H,KAAK2G,aAAavH,EAAED,GAAG,CAAC,kBAAMwH,CAAavH,EAAEkF,GAAG,KAAKlF,EAAEmI,iBAAiBI,oBAAoB,MAAMvI,EAAEsI,UAAU,MAAM,IAAIE,MAAM,MAAMzI,EAAEC,EAAEmI,MAAMlI,EAAEF,EAAE0I,WAAW,MAAMjI,QAAQI,KAAK4C,MAAMkF,cAAc1I,EAAEsI,UAAU,CAAC1B,OAAO1B,IAAIjD,EAAErB,KAAK4C,MAAMmF,YAAYnI,GAAGoI,WAAW,GAAG,MAAM3G,EAAE,MAAM,IAAIuG,MAAMzI,EAAE6B,MAAMK,EAAEL,MAAM7B,EAAE8I,OAAO5G,EAAE4G,OAAO,MAAM3I,EAAED,EAAE6I,gBAAgB7G,EAAEL,MAAMK,EAAE4G,QAAQ3I,EAAE6I,KAAKlG,IAAIZ,EAAE+G,aAAa/I,EAAEgJ,aAAa/I,EAAE,EAAE,EAAE,GAAG+B,GAAEjC,EAAAA,EAAAA,IAAE,EAACC,EAAAA,EAAAA,GAAE,0CAA0CgC,G,oCCAxhC,IAAIlC,EAAE,cAAcG,EAAAA,EAAEY,WAAAA,CAAYd,GAAGe,MAAMf,EAAE,CAACwH,UAAAA,GAAa5G,KAAKsB,gBAAgBgH,IAAI,IAAItI,KAAKuI,cAAc,IAAIvI,KAAKwI,eAAexI,KAAKsB,gBAAgBgH,IAAI,IAAItI,KAAKgD,cAAcC,KAAK7D,GAAGY,KAAKyI,wBAAwBrJ,GAAG,CAAC6H,SAAQ,GAAI,CAACwB,uBAAAA,CAAwBrJ,GAAG,GAAG,kBAAkBA,EAAE,YAAYY,KAAK0I,cAAcpE,GAAG,GAAGtE,KAAK2I,WAAWrE,GAAG,OAAO,MAAM1E,EAAE,CAAC8C,WAAU,EAAGkG,gBAAgB,EAAEC,aAAa,EAAEjG,MAAM5C,KAAK4C,OAAOvB,EAAErB,KAAK8I,UAAUnG,KAAKoG,eAAe1H,EAAE2H,4BAA4BpJ,GAAGI,KAAKqD,YAAWhE,EAAAA,EAAAA,IAAE,IAAIgC,EAAE4H,sBAAsBrJ,IAAI0E,EAAE,CAAC,qCAAM4E,CAAgC9J,EAAEC,GAAG,MAAM8J,eAAevJ,EAAEwJ,aAAa9J,GAAGU,KAAKb,EAAEa,KAAKqJ,sBAAsBjK,IAAIwB,KAAK0D,EAAEgF,OAAOpF,EAAES,WAAWH,GAAGpF,EAAE,GAAG,MAAMD,GAAG,MAAMG,EAAE,OAAO,MAAMyB,QAAQM,EAAAA,EAAAA,IAAErB,KAAK4C,MAAMsB,EAAEI,EAAE,GAAGA,EAAE,GAAGE,EAAEnF,GAAG,GAAG,MAAM0B,EAAE,OAAO,KAAK,MAAMJ,EAAE,CAAC4I,mBAAmBpK,EAAEqK,eAAepK,EAAEoK,eAAeC,SAAS1I,EAAEoI,eAAevJ,EAAE8J,eAAe1J,KAAK0J,eAAetK,KAAKuK,YAAYpG,SAASjE,EAAEsK,oBAAoBjJ,EAAEtB,GAAG,OAAOkE,CAAC,GAAGpE,GAAEC,EAAAA,EAAAA,IAAE,EAACQ,EAAAA,EAAAA,GAAE,mDAAmDT,GAAG,MAAMmF,EAAEuF,OAAO,oB,eCApxB,IAAIrJ,EAAE,eAAcO,EAAAA,EAAAA,GAAEuC,EAAAA,IAAIpD,WAAAA,GAAcC,SAASuE,WAAW1E,KAAK6C,KAAK,YAAY,CAAC,oBAAIiH,GAAmB,OAAO,IAAI,CAAC,aAAIpC,GAAY,OAAO,IAAI,CAACd,UAAAA,GAAa,MAAMxH,EAAEA,IAAIY,KAAK+J,iBAAiBxI,WAAWvB,KAAKgK,oBAAoBhK,KAAK+J,iBAAiBzB,IAAI,IAAItI,KAAK4C,OAAOqH,8BAA8BC,QAAQ9K,GAAGY,KAAK+J,iBAAiBzB,IAAI,IAAItI,KAAK4C,OAAOuH,SAAS/K,GAAGY,KAAK+J,iBAAiBzB,IAAI,IAAItI,KAAK2E,WAAWvF,GAAGY,KAAKoK,iBAAiB,IAAI7G,EAAAA,EAAE,CAACZ,KAAK3C,KAAK2C,KAAKC,MAAM5C,KAAK4C,MAAMtB,gBAAgBtB,KAAK+J,mBAAmB/J,KAAKqD,WAAW,EAAChE,EAAAA,EAAAA,IAAEW,KAAKoK,mBAAkBjL,EAAAA,EAAAA,IAAE,IAAIa,KAAKS,UAAUrB,GAAGY,KAAKoK,iBAAiB3J,UAAUrB,EAAEQ,EAAAA,KAAI,CAACyK,YAAAA,GAAerK,KAAKqD,WAAW,EAAClE,EAAAA,EAAAA,IAAE,IAAIa,KAAK4C,MAAMuH,SAAS/K,GAAGY,KAAKsK,iBAAiBlL,GAAGiC,EAAAA,KAAI,CAACiJ,gBAAAA,CAAiBlL,GAAG,MAAMC,EAAE,SAASD,GAAGyD,KAAK1D,EAAE,SAASa,KAAKuK,SAAS1H,KAAKjD,EAAEI,KAAKuK,QAAQ3K,GAAGP,IAAIF,IAAIa,KAAKuK,QAAQlL,EAAE,IAAI6E,EAAE,CAAC4E,UAAU9I,OAAO,IAAIwE,EAAE,CAACsE,UAAU9I,OAAOJ,GAAG4K,UAAU,CAACC,eAAAA,GAAkB,MAAM,CAAC9F,WAAW3E,KAAK2E,WAAW,CAACxD,SAAAA,CAAU/B,EAAEC,GAAG,OAAOW,KAAKoK,iBAAiBjJ,UAAU/B,EAAEC,EAAE,CAACqL,UAAAA,GAAa,OAAOvK,MAAMuK,cAAc1K,KAAKoK,iBAAiBrK,QAAQ,IAAGX,EAAAA,EAAAA,IAAE,EAACE,EAAAA,EAAAA,OAAKkB,EAAE+D,UAAU,mBAAmB,OAAMnF,EAAAA,EAAAA,IAAE,EAACE,EAAAA,EAAAA,OAAKkB,EAAE+D,UAAU,YAAY,MAAM/D,GAAEpB,EAAAA,EAAAA,IAAE,EAACkF,EAAAA,EAAAA,GAAE,4CAA4C9D,GAAG,MAAMS,EAAET,C","sources":["../node_modules/@arcgis/core/views/layers/support/highlightUtils.js","../node_modules/@arcgis/core/views/3d/layers/support/ImageHighlightHelper3D.js","../node_modules/@arcgis/core/views/layers/ImageryLayerView.js","../node_modules/@arcgis/core/views/3d/layers/ImagerySubView3D.js","../node_modules/@arcgis/core/views/3d/support/flow/FlowSubViewExtent3D.js","../node_modules/@arcgis/core/views/3d/layers/ImageryLayerView3D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{isSome as r}from\"../../../core/arrayUtils.js\";import o from\"../../../core/Collection.js\";import{isGraphic as t}from\"../../../support/guards.js\";function i(i){if(!i)return[];let e=t(i)?[i]:o.isCollection(i)?i.toArray():Array.isArray(i)?i:[];return e=e?.filter(r),0===(e?.length??0)?[]:e}export{i as getHighlightGraphics};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as i}from\"tslib\";import e from\"../../../../Color.js\";import t from\"../../../../core/Accessor.js\";import{isSome as r}from\"../../../../core/arrayUtils.js\";import{makeHandle as s,destroyHandle as o}from\"../../../../core/handleUtils.js\";import{watch as h,syncAndInitial as p}from\"../../../../core/reactiveUtils.js\";import{property as a}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/Logger.js\";import{subclass as l}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{initializeProjection as n,project as c}from\"../../../../geometry/projectionUtils.js\";import{GraphicsCollection as g}from\"../../../../support/GraphicsCollection.js\";import m from\"../../../../symbols/SimpleFillSymbol.js\";import d from\"../../../../symbols/SimpleLineSymbol.js\";import u from\"../../../../symbols/SimpleMarkerSymbol.js\";import{getHighlightGraphics as y}from\"../../../layers/support/highlightUtils.js\";let w=class extends t{get updating(){return this.graphicsView?.updating??!1}constructor(i){super(i),this._highlightCounts=new Map,this._graphicsViewLoader=null,this.graphics=new g,this.graphicsView=null,this.suspended=!1;const t=new e([255,255,255,1/255]);this._symbols=new Map([[\"point\",new u({size:\"2px\",style:\"square\",color:t})],[\"polyline\",new d({width:\"2px\",color:t})],[\"polygon\",new m({outline:null,color:t})]])}highlight(i,e){const t=y(i);if(0===t.length)return s();let r,o=!1;return this.updatingHandles.addPromise(Promise.all([this._createHighlightGraphics(t),this._ensureGraphicsView3D()]).then(([i,t])=>{!o&&t&&(r=this._addHighlightGraphics(t,i,e))})),s(()=>{o=!0,r?.remove()})}preload(){this._ensureGraphicsView3D()}_addHighlightGraphics(i,e,t){for(const s of e)this._highlightCounts.set(s,(this._highlightCounts.get(s)??0)+1);this.graphics.addMany(e);const r=i.highlight(e,t);return s(()=>{this._removeHighlightGraphics(e),r.remove()})}_removeHighlightGraphics(i){this.graphics.removeMany(i.filter(i=>{const e=Math.max(0,(this._highlightCounts.get(i)??0)-1);return 0===e?(this._highlightCounts.delete(i),!0):(this._highlightCounts.set(i,e),!1)}))}async _ensureGraphicsView3D(){if(this.graphicsView)return this.graphicsView;this._graphicsViewLoader||(this._graphicsViewLoader=import(\"../GraphicsView3D.js\"));const{default:i}=await this._graphicsViewLoader;if(this.destroyed)return null;const e=new i({view:this.view,layer:{type:\"graphics-view-3d-dummy\",id:this.layer.id,uid:this.layer.uid,elevationInfo:{mode:\"on-the-ground\"}},getGraphics:()=>this.graphics,drapeSourcePriorityOffset:.5});return this._set(\"graphicsView\",e),this.addHandles([o(this.graphicsView),h(()=>this.suspended,i=>{e.suspended=i},p)]),e}async _createHighlightGraphics(i){const e=i.map(({geometry:i})=>i?.spatialReference).filter(r).reduce((i,e)=>(0!==i.length&&i.at(-1)?.equals(e)||i.push(e),i),[]),t=this.view.spatialReference,s=e.map(i=>({source:i,dest:t}));try{await n(s)}catch{return[]}return i.map(i=>{const{geometry:e}=i;try{const r=e?c(e,t):null,s=i.cloneShallow();return s.geometry=r,s.symbol=this._symbols.get(r?.type),s}catch{return i}})}};i([a()],w.prototype,\"graphics\",void 0),i([a()],w.prototype,\"graphicsView\",void 0),i([a()],w.prototype,\"view\",void 0),i([a()],w.prototype,\"layer\",void 0),i([a()],w.prototype,\"updatingHandles\",void 0),i([a()],w.prototype,\"suspended\",void 0),i([a()],w.prototype,\"updating\",null),w=i([l(\"esri.views.3d.layers.support.ImageHighlightHelper3D\")],w);export{w as ImageHighlightHelper3D};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as e}from\"tslib\";import t from\"../../core/Error.js\";import{throwIfAborted as r}from\"../../core/promiseUtils.js\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as s}from\"../../core/accessorSupport/decorators/subclass.js\";import i from\"../../geometry/Point.js\";import a from\"../../layers/support/FieldsIndex.js\";import{rasterFieldPrefix as p}from\"../../layers/support/rasterFieldUtils.js\";import{combineTimeExtent as n}from\"../../layers/support/timeSupport.js\";import{load as l,getSourceScale as m}from\"../../layers/support/rasterFunctions/rasterProjectionHelper.js\";import u from\"../../rest/support/Query.js\";import{getFetchPopupTemplate as c}from\"./support/popupUtils.js\";const y=y=>{const d=y;let f=class extends d{constructor(...e){super(...e),this.view=null}get timeExtent(){return n(this.layer,this.view?.timeExtent,this._get(\"timeExtent\"))}async fetchPopupFeaturesAtLocation(e,o){const{layer:s}=this;if(!e)throw new t(\"imagerylayerview:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:s});const{popupEnabled:n}=s,l=c(s,o);if(!n||null==l)return[];const m=await l.getRequiredFields(null,{index:new a(s.rasterFields),partitions:new Map([[\"$pixel\",s.rasterFields.filter(e=>e.name.startsWith(p)).map(e=>e.name)],[\"$imageCollectionItem\",s.fields.map(e=>e.name)]])});r(o);const y=new u;y.timeExtent=this.timeExtent,y.geometry=e,y.outFields=m,y.outSpatialReference=e.spatialReference;const{resolution:d,spatialReference:f}=this.view,h=\"2d\"===this.view.type?new i(d,d,f):new i(.5*d,.5*d,f),{returnTopmostRaster:w,showNoDataRecords:R}=l.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1},j={returnDomainValues:!0,returnTopmostRaster:w,pixelSize:h,showNoDataRecords:R,signal:o?.signal};return s.queryVisibleRasters(y,j)}async getSourceScale(){return await l(),await this.layer.load(),m(this.layer.serviceRasterInfo,this.view.spatialReference)}canResume(){return!!super.canResume()&&!this.timeExtent?.isEmpty}};return e([o()],f.prototype,\"layer\",void 0),e([o()],f.prototype,\"suspended\",void 0),e([o({readOnly:!0})],f.prototype,\"timeExtent\",null),e([o()],f.prototype,\"view\",void 0),f=e([s(\"esri.views.layers.ImageryLayerView\")],f),f};export{y as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as e}from\"tslib\";import{debounce as a}from\"../../../core/promiseUtils.js\";import{when as i}from\"../../../core/reactiveUtils.js\";import\"../../../core/Logger.js\";import\"../../../core/has.js\";import\"../../../core/RandomLCG.js\";import\"../../../core/Error.js\";import{subclass as t}from\"../../../core/accessorSupport/decorators/subclass.js\";import r from\"./DrapedSubView3D.js\";let s=class extends r{constructor(e){super(e),this.redrawDebounced=a(async e=>{this.redraw((e,a)=>this._redrawImage(e,a),e)},2e3)}initialize(){this.addHandles([i(()=>this.view.basemapTerrain.ready,()=>this._initializeMaximumDataResolution(),{once:!0,initial:!0}),this.layer.on(\"redraw\",()=>this.updatingHandles.addPromise(this.redrawDebounced()))])}_initializeMaximumDataResolution(){this.maximumDataResolution=this.layer.loaded?this.layer.serviceRasterInfo.pixelSize:null}async processResult(e,a,i){a.imageOrCanvasElement?e.image=a.imageOrCanvasElement:(e.image=document.createElement(\"canvas\"),e.pixelData=a.pixelData,await this._redrawImage(e,i))}async _redrawImage(e,a){if(!(e.image instanceof HTMLCanvasElement)||null==e.pixelData)throw new Error;const i=e.image,t=i.getContext(\"2d\"),r=await this.layer.applyRenderer(e.pixelData,{signal:a}),s=this.layer.applyFilter(r).pixelBlock;if(null==s)throw new Error;i.width=s.width,i.height=s.height;const o=t.createImageData(s.width,s.height);o.data.set(s.getAsRGBA()),t.putImageData(o,0,0)}};s=e([t(\"esri.views.3d.layers.ImagerySubView3D\")],s);export{s as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as e}from\"tslib\";import{makeHandle as t}from\"../../../../core/handleUtils.js\";import\"../../../../core/Logger.js\";import\"../../../../core/has.js\";import\"../../../../core/RandomLCG.js\";import\"../../../../core/Error.js\";import{subclass as r}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{loadImagery as s}from\"../../../2d/engine/flow/dataUtils.js\";import o from\"../../layers/FlowSubView3D.js\";let i=class extends o{constructor(e){super(e)}initialize(){this.updatingHandles.add(()=>this.renderedTiles,()=>this.triggerLoad()),this.updatingHandles.add(()=>this.elevationInfo.mode,e=>this._updatePopupDrapeSource(e),{initial:!0})}_updatePopupDrapeSource(e){if(\"on-the-ground\"===e)return void this.removeHandles(a);if(this.hasHandles(a))return;const r={destroyed:!1,drapeSourceType:2,updatePolicy:0,layer:this.layer},s=this.layerView.view.overlayManager;s.registerGeometryDrapeSource(r),this.addHandles(t(()=>s.unregisterDrapeSource(r)),a)}async fetchDataAndGenerateStreamlines(e,t){const{needsMagnitude:r,workerHandle:o}=this,i=this.getSimulationSettings(e),{size:a,extent:n,timeExtent:l}=e;if(null==i||null==o)return;const d=await s(this.layer,n,a[0],a[1],l,t);if(null==d)return null;const u={simulationSettings:i,flowExtentInfo:e.flowExtentInfo,flowData:d,needsMagnitude:r,startPositions:this.startPositions(e)},{streamlines:p}=await o.generateStreamlines(u,t);return p}};i=e([r(\"esri.views.3d.support.flow.FlowSubViewExtent3D\")],i);const a=Symbol(\"popupDrapeSource\");export{i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as e}from\"tslib\";import{destroyHandle as t}from\"../../../core/handleUtils.js\";import{watch as i,syncAndInitial as r,initial as s}from\"../../../core/reactiveUtils.js\";import{property as o}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/Logger.js\";import\"../../../core/RandomLCG.js\";import{subclass as a}from\"../../../core/accessorSupport/decorators/subclass.js\";import h from\"./DynamicLayerView3D.js\";import l from\"./ImagerySubView3D.js\";import{ImageHighlightHelper3D as p}from\"./support/ImageHighlightHelper3D.js\";import n from\"../support/flow/FlowSubViewExtent3D.js\";import d from\"../../layers/ImageryLayerView.js\";let g=class extends(d(h)){constructor(){super(...arguments),this.type=\"imagery-3d\"}get highlightOptions(){return null}get pixelData(){return null}initialize(){const e=()=>this._updatingHandles.addPromise(this.refreshDebounced());this._updatingHandles.add(()=>this.layer?.exportImageServiceParameters?.version,e),this._updatingHandles.add(()=>this.layer?.renderer,e),this._updatingHandles.add(()=>this.timeExtent,e),this._highlightHelper=new p({view:this.view,layer:this.layer,updatingHandles:this._updatingHandles}),this.addHandles([t(this._highlightHelper),i(()=>this.suspended,e=>this._highlightHelper.suspended=e,r)])}_initSubView(){this.addHandles([i(()=>this.layer.renderer,e=>this._recreateSubView(e),s)])}_recreateSubView(e){const t=\"flow\"===e?.type,i=\"flow\"===this.subView?.type,r=this.subView;r&&t===i||(this.subView=t?new n({layerView:this}):new l({layerView:this}),r?.destroy())}getFetchOptions(){return{timeExtent:this.timeExtent}}highlight(e,t){return this._highlightHelper.highlight(e,t)}isUpdating(){return super.isUpdating()||this._highlightHelper.updating}};e([o()],g.prototype,\"highlightOptions\",null),e([o()],g.prototype,\"pixelData\",null),g=e([a(\"esri.views.3d.layers.ImageryLayerView3D\")],g);const m=g;export{m as default};\n"],"names":["i","e","t","o","isCollection","toArray","Array","isArray","filter","r","length","w","updating","this","graphicsView","constructor","super","_highlightCounts","Map","_graphicsViewLoader","graphics","g","suspended","_symbols","u","size","style","color","d","width","m","outline","highlight","y","s","updatingHandles","addPromise","Promise","all","_createHighlightGraphics","_ensureGraphicsView3D","then","_ref","_addHighlightGraphics","remove","preload","set","get","addMany","_removeHighlightGraphics","removeMany","Math","max","delete","default","destroyed","view","layer","type","id","uid","elevationInfo","mode","getGraphics","drapeSourcePriorityOffset","_set","addHandles","h","p","map","_ref2","geometry","spatialReference","reduce","at","equals","push","source","dest","n","c","cloneShallow","symbol","a","prototype","l","f","arguments","timeExtent","_get","fetchPopupFeaturesAtLocation","popupEnabled","getRequiredFields","index","rasterFields","partitions","name","startsWith","fields","outFields","outSpatialReference","resolution","returnTopmostRaster","showNoDataRecords","R","layerOptions","j","returnDomainValues","pixelSize","signal","queryVisibleRasters","getSourceScale","load","serviceRasterInfo","canResume","isEmpty","readOnly","redrawDebounced","async","redraw","_redrawImage","initialize","basemapTerrain","ready","_initializeMaximumDataResolution","once","initial","on","maximumDataResolution","loaded","processResult","imageOrCanvasElement","image","document","createElement","pixelData","HTMLCanvasElement","Error","getContext","applyRenderer","applyFilter","pixelBlock","height","createImageData","data","getAsRGBA","putImageData","add","renderedTiles","triggerLoad","_updatePopupDrapeSource","removeHandles","hasHandles","drapeSourceType","updatePolicy","layerView","overlayManager","registerGeometryDrapeSource","unregisterDrapeSource","fetchDataAndGenerateStreamlines","needsMagnitude","workerHandle","getSimulationSettings","extent","simulationSettings","flowExtentInfo","flowData","startPositions","streamlines","generateStreamlines","Symbol","highlightOptions","_updatingHandles","refreshDebounced","exportImageServiceParameters","version","renderer","_highlightHelper","_initSubView","_recreateSubView","subView","destroy","getFetchOptions","isUpdating"],"sourceRoot":""}