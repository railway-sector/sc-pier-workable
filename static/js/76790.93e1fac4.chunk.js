"use strict";(self.webpackChunksc_pier_workable=self.webpackChunksc_pier_workable||[]).push([[76790],{14303:(e,t,i)=>{i.d(t,{A:()=>g});var r,o=i(6326),s=i(42553),n=i(53084),a=i(62754),l=i(46053),c=(i(81806),i(76460),i(87990)),u=i(17707),h=i(37546),p=i(65215),d=i(56611);let g=r=class extends s.o{constructor(e){super(e),this.geometry=null,this.type="clip"}writeGeometry(e,t,i,r){if(r.layer?.spatialReference&&!r.layer.spatialReference.equals(this.geometry.spatialReference)){if(!(0,d.canProjectWithoutEngine)(e.spatialReference,r.layer.spatialReference))return void(r?.messages&&r.messages.push(new a.A("scenemodification:unsupported","Scene modifications with incompatible spatial references are not supported",{modification:this,spatialReference:r.layer.spatialReference,context:r})));const o=new p.A;(0,d.projectPolygon)(e,o,r.layer.spatialReference),t[i]=o.toJSON(r)}else t[i]=e.toJSON(r)}clone(){return new r({geometry:(0,n.o8)(this.geometry),type:this.type})}};(0,o.Cg)([(0,l.MZ)({type:p.A}),(0,h.P)()],g.prototype,"geometry",void 0),(0,o.Cg)([(0,u.K)(["web-scene","portal-item"],"geometry")],g.prototype,"writeGeometry",null),(0,o.Cg)([(0,l.MZ)({type:["clip","mask","replace"],nonNullable:!0}),(0,h.P)()],g.prototype,"type",void 0),g=r=(0,o.Cg)([(0,c.$)("esri.layers.support.SceneModification")],g)},23456:(e,t,i)=>{i.d(t,{_8:()=>m,dJ:()=>f,uB:()=>y});var r=i(15941),o=i(20664),s=i(9392),n=i(34111),a=i(76797),l=i(91605),c=i(13312),u=i(45308);function h(e,t){if(!Array.isArray(e)||e.length<t)return!1;for(const i of e)if("number"!=typeof i)return!1;return!0}const p=7645211,d={xmin:-180,ymin:-90,zmin:-450,xmax:180,ymax:90,zmax:8850},g=new Map([[5773,new l.A({heightModel:"gravity-related-height",heightUnit:"meters",vertCRS:"EGM96_Geoid"})],[3855,new l.A({heightModel:"gravity-related-height",heightUnit:"meters",vertCRS:"EGM2008_Geoid"})],[115700,new l.A({heightModel:"ellipsoidal",heightUnit:"meters",vertCRS:"WGS_1984"})],[115701,new l.A({heightModel:"ellipsoidal",heightUnit:"meters",vertCRS:"ETRS_1989"})],[6360,new l.A({heightModel:"gravity-related-height",heightUnit:"us-feet",vertCRS:"NAVD88_height_(ftUS)"})],[7837,new l.A({heightModel:"gravity-related-height",heightUnit:"meters",vertCRS:"DHHN2016_(height) "})]]);function f(e){if(!e)return null;const t=e.vcsWkid||e.latestVcsWkid;return t?g.get(t):null}function m(e){return!(!(e.extensions?.ESRI_crs?.wkid||e.extensions?.ESRI_crs?.latestWkid||e.extensions?.ESRI_crs?.wkt)||!e.root?.extensions?.ESRI_crs?.boundingVolume?.box&&!e.root?.extensions?.ESRI_crs?.boundingVolume?.sphere)}function y(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=new c.A({wkid:4326,vcsWkid:115700}),l=e.root?.boundingVolume,g=!1,f=e?.root?.transform;if(t&&(e.extensions?.ESRI_crs?.wkid||e.extensions?.ESRI_crs?.latestWkid||e.extensions?.ESRI_crs?.wkt)&&(e.root?.extensions?.ESRI_crs?.boundingVolume?.box||e.root?.extensions?.ESRI_crs?.boundingVolume?.sphere))i=new c.A(e.extensions?.ESRI_crs),l=e.root?.extensions?.ESRI_crs?.boundingVolume,f=e.root?.transform,g=!0;else if(!l)return new a.A(-180,-90,180,90,i);if(l.box){const e=l?.box;if(e[3]>p&&e[7]>p&&e[11]>p)return new a.A({...d,spatialReference:i})}const m=(0,s.vt)();if(!g&&l.region&&h(l.region,6)){const e=l.region,t=(0,r.KJ)(e[0]),o=(0,r.KJ)(e[1]),s=e[4],n=(0,r.KJ)(e[2]),c=(0,r.KJ)(e[3]),u=e[5];return new a.A({xmin:t,ymin:o,zmin:s,xmax:n,ymax:c,zmax:u,spatialReference:i})}if(l.sphere&&h(l.sphere,4)){const e=l.sphere,t=(0,s.fA)(e[0],e[1],e[2]),r=e[3]/Math.sqrt(3),p=(0,s.vt)();(0,o.e)(p,t,(0,s.fA)(r,r,r));const d=(0,s.vt)();if((0,o.g)(d,t,(0,s.fA)(r,r,r)),f&&h(f,16)){const e=f;(0,o.t)(m,p,e),(0,o.d)(p,m),(0,o.t)(m,d,e),(0,o.d)(d,m)}g||((0,u.projectBuffer)(p,n.Ro,0,p,c.A.WGS84,0),(0,u.projectBuffer)(d,n.Ro,0,d,c.A.WGS84,0));const y=(0,s.vt)(),A=(0,s.vt)();return(0,o.A)(y,p,d),(0,o.z)(A,p,d),new a.A({xmin:y[0],ymin:y[1],zmin:y[2],xmax:A[0],ymax:A[1],zmax:A[2],spatialReference:i})}if(l.box&&h(l.box,12)){const e=l.box,t=(0,s.fA)(e[0],e[1],e[2]),r=(0,s.fA)(e[3],e[4],e[5]),p=(0,s.fA)(e[6],e[7],e[8]),d=(0,s.fA)(e[9],e[10],e[11]),m=[];for(let i=0;i<8;++i)m.push((0,s.vt)());if((0,o.g)(m[0],t,r),(0,o.g)(m[0],m[0],p),(0,o.g)(m[0],m[0],d),(0,o.a)(m[1],t,r),(0,o.g)(m[1],m[1],p),(0,o.g)(m[1],m[1],d),(0,o.g)(m[2],t,r),(0,o.a)(m[2],m[2],p),(0,o.g)(m[2],m[2],d),(0,o.a)(m[3],t,r),(0,o.a)(m[3],m[3],p),(0,o.g)(m[3],m[3],d),(0,o.g)(m[4],t,r),(0,o.g)(m[4],m[4],p),(0,o.a)(m[4],m[4],d),(0,o.a)(m[5],t,r),(0,o.g)(m[5],m[5],p),(0,o.a)(m[5],m[5],d),(0,o.g)(m[6],t,r),(0,o.a)(m[6],m[6],p),(0,o.a)(m[6],m[6],d),(0,o.a)(m[7],t,r),(0,o.a)(m[7],m[7],p),(0,o.a)(m[7],m[7],d),f&&h(f,16)){const e=f;for(let t=0;t<8;++t)(0,o.t)(m[t],m[t],e)}const y=(0,s.fA)(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),A=(0,s.fA)(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);for(let i=0;i<8;++i)g||(0,u.projectBuffer)(m[i],n.Ro,0,m[i],c.A.WGS84,0),(0,o.A)(A,A,m[i]),(0,o.z)(y,y,m[i]);return new a.A({xmin:A[0],ymin:A[1],zmin:A[2],xmax:y[0],ymax:y[1],zmax:y[2],spatialReference:i})}return new a.A(-180,-90,180,90,i)}},49050:(e,t,i)=>{i.d(t,{A:()=>p});var r,o=i(6326),s=i(3825),n=i(19276),a=i(42553),l=i(90534),c=i(46053),u=(i(81806),i(76460),i(47249),i(87990)),h=i(14303);let p=r=class extends((0,a.T)(n.A.ofType(h.A))){constructor(e){super(e),this.url=null}clone(){return new r({url:this.url,items:this.items.map(e=>e.clone())})}toJSON(e){return this.toArray().map(t=>t.toJSON(e)).filter(e=>!!e.geometry)}static fromJSON(e,t){const i=new r;for(const r of e)i.add(h.A.fromJSON(r,t));return i}static async fromUrl(e,t,i){const o={url:(0,l.An)(e),origin:"service"},n=await(0,s.A)(e,{responseType:"json",signal:i?.signal}),a=t.toJSON(),c=[];for(const r of n.data)c.push(h.A.fromJSON({...r,geometry:{spatialReference:a,...r.geometry}},o));return new r({url:e,items:c})}};(0,o.Cg)([(0,c.MZ)({type:String})],p.prototype,"url",void 0),p=r=(0,o.Cg)([(0,u.$)("esri.layers.support.SceneModifications")],p)},76790:(e,t,i)=>{i.r(t),i.d(t,{default:()=>I});var r=i(6326),o=i(3825),s=i(50076),n=i(76460),a=i(77717),l=i(50346),c=i(68134),u=i(46053),h=(i(81806),i(47249),i(28379)),p=i(87990),d=i(37546),g=i(76797),f=i(13312),m=i(25515),y=i(12406),A=i(19502),_=i(31362),S=i(11270),w=i(94729),v=i(5682),x=i(95363),R=i(49050),b=i(23456),M=i(44568),T=i(12482),k=i(79453),E=i(50917);let C=class extends((0,A.b)((0,S.q)((0,w.A)((0,v.j)((0,a.P)((0,_.d)((0,y.p)(m.A)))))))){readModifications(e,t,i){this._modificationsSource={url:(0,k.f)(e,i),context:i}}initialize(){this.addHandles((0,c.on)(()=>this.modifications,"after-changes",()=>this.modifications=this.modifications,c.OH))}constructor(e){super(e),this.operationalLayerType="IntegratedMesh3DTilesLayer",this.modifications=null,this._modificationsSource=null,this.spatialReference=new f.A({wkid:4326,vcsWkid:115700}),this.fullExtent=new g.A(-180,-90,180,90,this.spatialReference),this.url=null,this.type="integrated-mesh-3dtiles",this.path=null,this.minScale=0,this.maxScale=0,this._rootTilesetJSON=null,this._rootTileset=null,this._key=null,this._session=null,this._rootRequestPromise=null}set elevationInfo(e){null!=e&&"absolute-height"!==e.mode||this._set("elevationInfo",e),this._validateElevationInfo(e)}async load(e){return this.addResolvingPromise(this._doLoad(e)),this}get rootTilesetJSON(){return this._rootTilesetJSON}get rootTileset(){return this._rootTileset}get key(){return this._key}get session(){return this._session}_findSessionParameter(e){const t=[e];for(;t?.length>0;){const e=t.pop();if(!e)return;for(const[r,o]of Object.entries(e)){if("uri"===r)try{const e=new URL("https://tmp"+o).searchParams.get("session");if(e)return e}catch(i){}"object"==typeof o&&null!==o&&t.push(o)}}return null}async requestRootAndSession(e){const t=(e,t)=>new s.A("3dtiles-init:"+e,t);return this._rootRequestPromise||(this._rootRequestPromise=new Promise((i,r)=>{this.url||r(t("url-missing","Layer url missing")),this._key=this.customParameters?this.customParameters.key:null,new Promise((e,i)=>{if(this.replacesTerrain&&!this._key){const r=this.portalItem?.portal||this.parent?.portalItem?.portal||M.A.getDefault();r.signIn().then(()=>{r.g3dTilesEnabled?(0,o.A)(r.restUrl+"/portals/self/modules/g3dtiles",{responseType:"json",query:{f:"json"}}).then(t=>{this._key=t.data.keyString,e()},()=>i(t("g3dtiles-key-error","Error fetching Google 3D Tiles key from portal"))):i(t("g3dTilesEnabled-false","Google 3D Tiles are not enabled on Portal "+r.url))},()=>i(t("sign-in-failed","Error signing in to Portal")))}else e()}).then(()=>{(0,o.A)(this.url,{query:this._key?{key:this._key,token:this.apiKey}:{token:this.apiKey},responseType:"array-buffer",signal:e}).then(e=>{try{this._rootTilesetJSON=JSON.parse((new TextDecoder).decode(e.data))}catch(o){return void r(t("root-parse-failed","Error parsing root tile, details: "+o))}this._rootTilesetJSON?(this._session=this._findSessionParameter(this._rootTilesetJSON),this._rootTileset=e.data,this.fullExtent=(0,b.uB)(this._rootTilesetJSON),i(),this._rootRequestPromise=null):r(t("root-is-null","Root tile is null."))},e=>{(0,l.QP)(e),r(t("root-load-failed","Error loading root tile")),this._rootRequestPromise=null,n.A.getLogger("IntegratedMesh3DTilesLayer").error("Layer loading failed",e)})},e=>r(e))})),this._rootRequestPromise}async _doLoad(e){const t=null!=e?e.signal:null;if(this._isUsedAsGroundLayer)throw new s.A("3dtiles-init:not-supported-in-groundlayers","Layer is not supported in basemap.");try{await this.loadFromPortal({supportedTypes:["3DTiles Service"],validateItem:e=>{if(e.typeKeywords?.includes("IntegratedMesh"))return!0;throw new s.A("portal:invalid-layer-item-type","Invalid layer item, expected '${expectedType}' ",{expectedType:"3DTiles Service containing IntegratedMesh"})}},e)}catch(i){(0,l.QP)(i)}if(null!=this._modificationsSource){const t=await R.A.fromUrl(this._modificationsSource.url,this.spatialReference,e);this.setAtOrigin("modifications",t,this._modificationsSource.context.origin),this._modificationsSource=null}await this.requestRootAndSession(t)}beforeSave(){if(null!=this._modificationsSource)return this.load().then(()=>{},()=>{})}get hasAttributionData(){return!1}async fetchAttributionData(){return{}}_validateElevationInfo(e){const t="Integrated mesh 3d tiles layers";(0,T.XF)(n.A.getLogger(this),(0,T.B)(t,"absolute-height",e)),(0,T.XF)(n.A.getLogger(this),(0,T.tW)(t,e))}get replacesTerrain(){return!1}get _isUsedAsGroundLayer(){return(0,E.S)(this.parent)}get hasGoogleUrl(){return!!this.url?.match(/.+\.googleapis.com/)}};(0,r.Cg)([(0,u.MZ)({type:["IntegratedMesh3DTilesLayer"]})],C.prototype,"operationalLayerType",void 0),(0,r.Cg)([(0,u.MZ)({type:R.A,clonable:e=>e.clone()}),(0,d.P)({origins:["web-scene","portal-item"],type:"resource",prefix:"modifications"})],C.prototype,"modifications",void 0),(0,r.Cg)([(0,h.w)(["web-scene","portal-item"],"modifications")],C.prototype,"readModifications",null),(0,r.Cg)([(0,u.MZ)({type:f.A})],C.prototype,"spatialReference",void 0),(0,r.Cg)([(0,u.MZ)({type:g.A})],C.prototype,"fullExtent",void 0),(0,r.Cg)([(0,u.MZ)(x.Yj)],C.prototype,"elevationInfo",null),(0,r.Cg)([(0,u.MZ)({type:["show","hide"]})],C.prototype,"listMode",void 0),(0,r.Cg)([(0,u.MZ)(x.OZ)],C.prototype,"url",void 0),(0,r.Cg)([(0,u.MZ)({readOnly:!0})],C.prototype,"type",void 0),(0,r.Cg)([(0,u.MZ)({type:String,json:{origins:{"web-scene":{read:!0,write:!0},"portal-item":{read:!0,write:!0}},read:!1}})],C.prototype,"path",void 0),(0,r.Cg)([(0,u.MZ)({type:Number,json:{name:"layerDefinition.minScale",write:!0,origins:{service:{read:!1,write:!1}}}})],C.prototype,"minScale",void 0),(0,r.Cg)([(0,u.MZ)({type:Number,json:{name:"layerDefinition.maxScale",write:!0,origins:{service:{read:!1,write:!1}}}})],C.prototype,"maxScale",void 0),(0,r.Cg)([(0,u.MZ)()],C.prototype,"replacesTerrain",null),(0,r.Cg)([(0,u.MZ)()],C.prototype,"_isUsedAsGroundLayer",null),(0,r.Cg)([(0,u.MZ)()],C.prototype,"hasGoogleUrl",null),C=(0,r.Cg)([(0,p.$)("esri.layers.IntegratedMesh3DTilesLayer")],C);const I=C}}]);
//# sourceMappingURL=76790.93e1fac4.chunk.js.map