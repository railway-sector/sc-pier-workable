{"version":3,"file":"static/js/13230.29f6a3d6.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/views/3d/layers/support/SublayerPopupHighlightHelper3D.js","../node_modules/@arcgis/core/views/3d/layers/support/ImageHighlightHelper3D.js","../node_modules/@arcgis/core/views/3d/layers/MapImageLayerView3D.js","../node_modules/@arcgis/core/layers/support/timeSupport.js","../node_modules/@arcgis/core/support/timeUtils.js","../node_modules/@arcgis/core/views/layers/MapImageLayerView.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as e}from\"tslib\";import i from\"../../../../core/Accessor.js\";import{destroyHandle as r}from\"../../../../core/handleUtils.js\";import{ignoreAbortErrors as t}from\"../../../../core/promiseUtils.js\";import{when as s,watch as p,initial as o,syncAndInitial as h}from\"../../../../core/reactiveUtils.js\";import{property as a}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/Logger.js\";import\"../../../../core/RandomLCG.js\";import{subclass as l}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{ImageHighlightHelper3D as c}from\"./ImageHighlightHelper3D.js\";import{MapServiceLayerViewHelper as g}from\"../../../layers/support/MapServiceLayerViewHelper.js\";import{createQueryGeometry as d}from\"../../../support/drapedUtils.js\";let m=class extends i{constructor(e){super(e)}initialize(){this._highlightHelper=new c({layer:this.layerView.layer,view:this.view,updatingHandles:this.updatingHandles}),this._mapServiceLayerViewHelper=new g({createFetchPopupFeaturesQueryGeometry:(e,i)=>d(e,i,this.view),layerView:this.layerView,updatingHandles:this.updatingHandles,highlightGraphics:this._highlightHelper.graphics,highlightGraphicUpdated:e=>this._highlightHelper.graphicsView?.graphicChanged(e)}),this.addHandles([r(this._mapServiceLayerViewHelper),s(()=>this._mapServiceLayerViewHelper.highlightFeaturesActive&&this.view?.stationary,()=>t(this._mapServiceLayerViewHelper.updateHighlightedFeatures(this.view.resolution)),o),p(()=>this.layerView.suspended,e=>this._highlightHelper.suspended=e,h)])}fetchPopupFeaturesAtLocation(e,i){return this._highlightHelper.preload(),this._mapServiceLayerViewHelper.fetchPopupFeaturesAtLocation(e,i)}highlight(e,i){return this._highlightHelper.highlight(e,i)}};e([a()],m.prototype,\"view\",void 0),e([a()],m.prototype,\"layerView\",void 0),e([a()],m.prototype,\"updatingHandles\",void 0),m=e([l(\"esri.views.3d.layers.support.SublayerPopupHighlightHelper3D\")],m);export{m as SublayerPopupHighlightHelper3D};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as i}from\"tslib\";import e from\"../../../../Color.js\";import t from\"../../../../core/Accessor.js\";import{isSome as r}from\"../../../../core/arrayUtils.js\";import{makeHandle as s,destroyHandle as o}from\"../../../../core/handleUtils.js\";import{watch as h,syncAndInitial as p}from\"../../../../core/reactiveUtils.js\";import{property as a}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/Logger.js\";import{subclass as l}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{initializeProjection as n,project as c}from\"../../../../geometry/projectionUtils.js\";import{GraphicsCollection as g}from\"../../../../support/GraphicsCollection.js\";import m from\"../../../../symbols/SimpleFillSymbol.js\";import d from\"../../../../symbols/SimpleLineSymbol.js\";import u from\"../../../../symbols/SimpleMarkerSymbol.js\";import{getHighlightGraphics as y}from\"../../../layers/support/highlightUtils.js\";let w=class extends t{get updating(){return this.graphicsView?.updating??!1}constructor(i){super(i),this._highlightCounts=new Map,this._graphicsViewLoader=null,this.graphics=new g,this.graphicsView=null,this.suspended=!1;const t=new e([255,255,255,1/255]);this._symbols=new Map([[\"point\",new u({size:\"2px\",style:\"square\",color:t})],[\"polyline\",new d({width:\"2px\",color:t})],[\"polygon\",new m({outline:null,color:t})]])}highlight(i,e){const t=y(i);if(0===t.length)return s();let r,o=!1;return this.updatingHandles.addPromise(Promise.all([this._createHighlightGraphics(t),this._ensureGraphicsView3D()]).then(([i,t])=>{!o&&t&&(r=this._addHighlightGraphics(t,i,e))})),s(()=>{o=!0,r?.remove()})}preload(){this._ensureGraphicsView3D()}_addHighlightGraphics(i,e,t){for(const s of e)this._highlightCounts.set(s,(this._highlightCounts.get(s)??0)+1);this.graphics.addMany(e);const r=i.highlight(e,t);return s(()=>{this._removeHighlightGraphics(e),r.remove()})}_removeHighlightGraphics(i){this.graphics.removeMany(i.filter(i=>{const e=Math.max(0,(this._highlightCounts.get(i)??0)-1);return 0===e?(this._highlightCounts.delete(i),!0):(this._highlightCounts.set(i,e),!1)}))}async _ensureGraphicsView3D(){if(this.graphicsView)return this.graphicsView;this._graphicsViewLoader||(this._graphicsViewLoader=import(\"../GraphicsView3D.js\"));const{default:i}=await this._graphicsViewLoader;if(this.destroyed)return null;const e=new i({view:this.view,layer:{type:\"graphics-view-3d-dummy\",id:this.layer.id,uid:this.layer.uid,elevationInfo:{mode:\"on-the-ground\"}},getGraphics:()=>this.graphics,drapeSourcePriorityOffset:.5});return this._set(\"graphicsView\",e),this.addHandles([o(this.graphicsView),h(()=>this.suspended,i=>{e.suspended=i},p)]),e}async _createHighlightGraphics(i){const e=i.map(({geometry:i})=>i?.spatialReference).filter(r).reduce((i,e)=>(0!==i.length&&i.at(-1)?.equals(e)||i.push(e),i),[]),t=this.view.spatialReference,s=e.map(i=>({source:i,dest:t}));try{await n(s)}catch{return[]}return i.map(i=>{const{geometry:e}=i;try{const r=e?c(e,t):null,s=i.cloneShallow();return s.geometry=r,s.symbol=this._symbols.get(r?.type),s}catch{return i}})}};i([a()],w.prototype,\"graphics\",void 0),i([a()],w.prototype,\"graphicsView\",void 0),i([a()],w.prototype,\"view\",void 0),i([a()],w.prototype,\"layer\",void 0),i([a()],w.prototype,\"updatingHandles\",void 0),i([a()],w.prototype,\"suspended\",void 0),i([a()],w.prototype,\"updating\",null),w=i([l(\"esri.views.3d.layers.support.ImageHighlightHelper3D\")],w);export{w as ImageHighlightHelper3D};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as e}from\"tslib\";import{destroyHandle as t}from\"../../../core/handleUtils.js\";import\"../../../core/Logger.js\";import\"../../../core/has.js\";import\"../../../core/RandomLCG.js\";import\"../../../core/Error.js\";import{subclass as i}from\"../../../core/accessorSupport/decorators/subclass.js\";import r from\"./DynamicLayerView3D.js\";import{SublayerPopupHighlightHelper3D as s}from\"./support/SublayerPopupHighlightHelper3D.js\";import o from\"../../layers/MapImageLayerView.js\";let p=class extends(o(r)){constructor(){super(...arguments),this.type=\"map-image-3d\"}initialize(){this._updatingHandles.add(()=>this.exportImageVersion,()=>this._updatingHandles.addPromise(this.refreshDebounced())),this._popupHighlightHelper=new s({view:this.view,layerView:this,updatingHandles:this._updatingHandles}),this.addHandles(t(this._popupHighlightHelper))}fetchPopupFeaturesAtLocation(e,t){return this._popupHighlightHelper.fetchPopupFeaturesAtLocation(e,t)}highlight(e,t){return this._popupHighlightHelper.highlight(e,t)}getFetchOptions(){return{timeExtent:this.timeExtent,scale:this.view.scale}}};p=e([i(\"esri.views.3d.layers.MapImageLayerView3D\")],p);const a=p;export{a as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{toLocalTimeExtent as e,toUTCTimeExtent as t}from\"../../support/timeUtils.js\";function i(i,n,s){if(null==i?.timeInfo)return null;const{datesInUnknownTimezone:l=!1,timeOffset:o,useViewTime:m}=i;let u=i.timeExtent;l&&(u=e(u));let r=m?n&&u?n.intersection(u):n||u:u;return!r||r.isEmpty||r.isAllTime?r:(o&&(r=r.offset(-o.value,o.unit)),l&&(r=t(r)),r.equals(s)?s:r)}export{i as combineTimeExtent};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{isSome as t}from\"../core/arrayUtils.js\";import{clone as e}from\"../core/lang.js\";import{offsetDate as n}from\"../core/timeUtils.js\";import i from\"../time/TimeExtent.js\";import{isWebMap as r}from\"../webmap/utils.js\";import{isWebScene as l}from\"../webscene/utils.js\";function s(t){return void 0!==t.timeInfo}async function u(t,e){return t.widgets?.timeSlider?.fullTimeExtent??a(t.allLayers,e)}function o(t){const e=t.numThumbs??2,n=t.currentTimeExtent;if(n){const{start:t,end:i}=n;return null!=t&&null!=i&&t.getTime()===i.getTime()?\"instant\":2===e?\"time-window\":null==t||0===t.getTime()?\"cumulative-from-start\":\"cumulative-from-end\"}return 2===e?\"time-window\":\"cumulative-from-start\"}function m(t){const{numStops:n,stopInterval:i,stops:r}=t;return r?{dates:e(r)}:i?{interval:i.clone()}:{count:n??5}}async function a(e,n){if(0===e.length)return i.allTime;await Promise.all(e.map(t=>t.load({signal:n})));const r=e.filter(s),l=e.filter(t=>!s(t)&&null!=t.visibilityTimeExtent);if(0===r.length&&0===l.length)return i.allTime;const u=[],o=[];for(const t of r)\"feature\"!==t?.type&&\"map-image\"!==t?.type||!t.timeInfo?.hasLiveData?o.push(t):u.push(t);const m=t=>null==t||t.isAllTime,a=[...o.map(t=>{const e=t.timeInfo?.fullTimeExtent,{visibilityTimeExtent:n}=t;return e?.intersection(n)??n}),...l.map(t=>t.visibilityTimeExtent)];if(a.some(m))return i.allTime;const f=u.map(async t=>{const e=(await t.fetchRecomputedExtents({signal:n}))?.timeExtent??t.timeInfo?.fullTimeExtent,{visibilityTimeExtent:i}=t;return e?.intersection(i)??i}),c=(await Promise.allSettled(f)).map(t=>\"fulfilled\"===t.status?t.value:null);if(c.some(m))return i.allTime;const d=[...c,...a].filter(t);if(0===d.length)return i.allTime;return d.reduce((t,e)=>t.union(e))}function f(t,e){const n=t.currentTimeExtent;if(!n)return null;const{start:r,end:l}=n,s=r??l??null;switch(e){case\"time-window\":return new i({start:r,end:l});case\"cumulative-from-start\":return new i({start:null,end:s});case\"cumulative-from-end\":return new i({start:s,end:null});case\"instant\":return new i({start:s,end:s})}}async function c(t,e){if(!r(t)&&!l(t))return null;await t.load({signal:e});const n=t?.widgets?.timeSlider;if(!n)return null;const i=await u(t,e),s=n.loop,a=o(n);return{fullTimeExtent:i,loop:s,mode:a,playRate:n.stopDelay??2e3,stops:m(n),timeExtent:f(n,a)}}function d(t){if(!t)return t;const{start:e,end:r}=t;return new i({start:null!=e?n(e,-e.getTimezoneOffset(),\"minutes\"):e,end:null!=r?n(r,-r.getTimezoneOffset(),\"minutes\"):r})}function p(t){if(!t)return t;const{start:e,end:r}=t;return new i({start:null!=e?n(e,e.getTimezoneOffset(),\"minutes\"):e,end:null!=r?n(r,r.getTimezoneOffset(),\"minutes\"):r})}export{a as getTimeExtentFromLayers,c as getTimeSliderSettingsFromWebDocument,p as toLocalTimeExtent,d as toUTCTimeExtent};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as e}from\"tslib\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as r}from\"../../core/accessorSupport/decorators/subclass.js\";import{ExportImageParameters as o}from\"../../layers/support/ExportImageParameters.js\";import{combineTimeExtent as s}from\"../../layers/support/timeSupport.js\";const i=i=>{const p=i;let a=class extends p{initialize(){this.exportImageParameters=new o({layer:this.layer})}destroy(){this.exportImageParameters.destroy(),this.exportImageParameters=null}get floors(){return this.view?.floors??null}get exportImageVersion(){return this.exportImageParameters?.commitProperty(\"version\"),this.commitProperty(\"timeExtent\"),this.commitProperty(\"floors\"),(this._get(\"exportImageVersion\")||0)+1}get timeExtent(){return s(this.layer,this.view?.timeExtent,this._get(\"timeExtent\"))}canResume(){return!!super.canResume()&&!this.timeExtent?.isEmpty}};return e([t()],a.prototype,\"exportImageParameters\",void 0),e([t({readOnly:!0})],a.prototype,\"floors\",null),e([t({readOnly:!0})],a.prototype,\"exportImageVersion\",null),e([t()],a.prototype,\"layer\",void 0),e([t()],a.prototype,\"suspended\",void 0),e([t({readOnly:!0})],a.prototype,\"timeExtent\",null),a=e([r(\"esri.views.layers.MapImageLayerView\")],a),a};export{i as default};\n"],"names":["m","i","constructor","e","super","initialize","this","_highlightHelper","c","layer","layerView","view","updatingHandles","_mapServiceLayerViewHelper","g","createFetchPopupFeaturesQueryGeometry","d","highlightGraphics","graphics","highlightGraphicUpdated","graphicsView","graphicChanged","addHandles","r","s","highlightFeaturesActive","stationary","t","updateHighlightedFeatures","resolution","o","p","suspended","h","fetchPopupFeaturesAtLocation","preload","highlight","a","prototype","l","w","updating","_highlightCounts","Map","_graphicsViewLoader","_symbols","u","size","style","color","width","outline","y","length","addPromise","Promise","all","_createHighlightGraphics","_ensureGraphicsView3D","then","_ref","_addHighlightGraphics","remove","set","get","addMany","_removeHighlightGraphics","removeMany","filter","Math","max","delete","default","destroyed","type","id","uid","elevationInfo","mode","getGraphics","drapeSourcePriorityOffset","_set","map","_ref2","geometry","spatialReference","reduce","at","equals","push","source","dest","n","cloneShallow","symbol","arguments","_updatingHandles","add","exportImageVersion","refreshDebounced","_popupHighlightHelper","getFetchOptions","timeExtent","scale","timeInfo","datesInUnknownTimezone","timeOffset","useViewTime","start","end","getTimezoneOffset","intersection","isEmpty","isAllTime","offset","value","unit","exportImageParameters","destroy","floors","commitProperty","_get","canResume","readOnly"],"sourceRoot":""}